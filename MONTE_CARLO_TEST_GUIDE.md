# 蒙地卡羅模擬測試指南

## 🧪 測試方法

### 1. 基本功能測試

#### 開啟蒙地卡羅功能
1. 在應用程式中找到「蒙地卡羅模擬」區塊
2. 勾選「使用蒙地卡羅模擬」選項
3. 設定波動率（建議 15%）
4. 設定模擬次數（建議 1000 次）

#### 驗證結果顯示
- ✅ 成功率與破產機率卡片
- ✅ 最佳/中位數/最差情況所需資產
- ✅ 百分位數分佈（5th, 25th, 75th, 95th）
- ✅ 風險說明文字

### 2. 參數測試

#### 波動率測試
| 波動率 | 預期結果 |
|--------|----------|
| 5% | 成功率較高，破產機率較低 |
| 15% | 中等風險，平衡的成功率 |
| 25% | 成功率較低，破產機率較高 |

#### 模擬次數測試
| 模擬次數 | 預期結果 |
|----------|----------|
| 100 | 快速結果，但可能不夠精確 |
| 1000 | 平衡的速度和精確度 |
| 10000 | 最精確，但計算時間較長 |

### 3. 邊界條件測試

#### 極端參數測試
```javascript
// 測試案例 1: 極低波動率
{
  volatility: 1.0,
  simulations: 1000,
  expected: "成功率應該很高 (>90%)"
}

// 測試案例 2: 極高波動率
{
  volatility: 50.0,
  simulations: 1000,
  expected: "成功率應該很低 (<30%)"
}

// 測試案例 3: 短期規劃
{
  years: 10,
  volatility: 15.0,
  expected: "成功率應該比 30 年規劃高"
}
```

### 4. 數學驗證

#### 隨機數分佈驗證
- 使用 Box-Muller 轉換生成常態分佈
- 驗證生成的報酬率符合預期的均值和標準差
- 檢查是否有異常值（如負的報酬率）

#### 成功率計算驗證
```javascript
// 驗證公式
successRate = (successCount / totalSimulations) * 100
bankruptcyProbability = 100 - successRate

// 驗證邏輯
// 1. 每次模擬都應該產生不同的結果
// 2. 成功率應該在 0-100% 之間
// 3. 波動率越高，成功率應該越低
```

### 5. 效能測試

#### 計算時間測試
| 模擬次數 | 預期計算時間 |
|----------|-------------|
| 100 | < 1 秒 |
| 1000 | 1-3 秒 |
| 10000 | 5-15 秒 |

#### 記憶體使用測試
- 監控瀏覽器記憶體使用
- 確保大量模擬不會導致瀏覽器崩潰

### 6. 使用者體驗測試

#### 介面測試
- ✅ 開關功能正常
- ✅ 參數輸入驗證
- ✅ 結果顯示清晰
- ✅ 響應式設計

#### 錯誤處理測試
- 輸入無效參數時的錯誤提示
- 計算失敗時的錯誤處理
- 網路中斷時的處理

### 7. 實際案例測試

#### 案例 1: 保守投資者
```javascript
{
  withdrawal: 1000000,
  years: 25,
  volatility: 10.0,
  expected: "成功率應該 > 80%"
}
```

#### 案例 2: 積極投資者
```javascript
{
  withdrawal: 2000000,
  years: 40,
  volatility: 20.0,
  expected: "成功率應該 < 60%"
}
```

#### 案例 3: 平衡投資者
```javascript
{
  withdrawal: 1500000,
  years: 30,
  volatility: 15.0,
  expected: "成功率應該在 60-80% 之間"
}
```

## 🐛 常見問題與解決方案

### 問題 1: 計算時間過長
**解決方案:**
- 減少模擬次數到 500-1000
- 檢查是否有無限迴圈
- 優化計算邏輯

### 問題 2: 結果不一致
**解決方案:**
- 確保隨機數生成器正常工作
- 檢查計算邏輯是否正確
- 驗證輸入參數

### 問題 3: 成功率異常
**解決方案:**
- 檢查波動率設定是否合理
- 驗證報酬率計算
- 確認破產判定邏輯

## 📊 預期結果

### 正常情況下的預期結果
- **成功率:** 60-85% (取決於參數)
- **破產機率:** 15-40%
- **最佳情況:** 比基本計算低 10-20%
- **最差情況:** 比基本計算高 30-50%

### 驗證清單
- [ ] 蒙地卡羅開關正常工作
- [ ] 波動率參數影響結果
- [ ] 模擬次數影響精確度
- [ ] 結果顯示完整且正確
- [ ] 計算時間在合理範圍內
- [ ] 錯誤處理正常
- [ ] 響應式設計正常

## 🎯 測試完成標準

當以下所有項目都通過時，蒙地卡羅功能測試完成：

1. ✅ 基本功能正常運作
2. ✅ 參數變化產生預期結果
3. ✅ 邊界條件處理正確
4. ✅ 數學計算準確
5. ✅ 效能符合要求
6. ✅ 使用者體驗良好
7. ✅ 實際案例測試通過 